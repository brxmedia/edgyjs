<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
    <title>edgyjs</title>
    <style>
        body {
            font-family: sans-serif;
        }
        #source {
            padding: 15px;
            margin-top: 50px;
            background-color: yellow;
        }
    </style>
</head>
<body>
    <div class="touchsquare" style="background-color: lightgray; width:500px; height: 500px;">
        <svg width="100%" height="100%" viewBox="0 0 500 500">
            <circle id="circ" cx="-20" cy="-20" r="10"></circle>
        </svg>
    </div>
    <div id="source">
        <div id="posX">current X:</div>
        <div id="posY">current Y:</div>
        <div id="status">status:</div>
        <div id="startDragX">startDrag X:</div>
        <div id="startDragY">startDrag Y:</div>
        <div id="draggedX">dragged X:</div>
        <div id="draggedY">dragged Y:</div>
    </div>
    <script>

        window.onload = init;
        var dragging = false;
        var currentX = 0;
        var currentY = 0;

        var startDragX = 0;
        var startDragY = 0;

        function init() {
            if (window.Event) {
                document.captureEvents(Event.MOUSEMOVE);
            }
            document.onmousemove = getCursorPosition;
        }

        function getCursorPosition(e) {
            currentX = ((window.Event) ? e.pageX : event.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft));
            currentY = ((window.Event) ? e.pageY : event.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop));

            document.getElementById('posX').innerHTML = "current X: " + currentX;
            document.getElementById('posY').innerHTML = "current Y: " + currentY;
        }

        function addEvent(element, type, fn) {
            // custom add event function that cares about compatibility
            return document.querySelector(element).addEventListener(type, fn);
        }

        function onMouseDown() {
            dragging = true;
            document.getElementById('status').innerHTML = 'status: start dragging';
            startDragX = currentX;
            startDragY = currentY;
            document.getElementById('startDragX').innerHTML = 'startDrag X: ' + startDragX;
            document.getElementById('startDragY').innerHTML = 'startDrag Y: ' + startDragY;
        }

        function onMouseMove() {
            if (!dragging) return; // skip dragging action if mouse button not depressed
            // do your dragging stuff
            document.getElementById('status').innerHTML = 'status: dragging';

            var dragX = currentX - startDragX;
            var dragY = currentY - startDragY;
            document.getElementById('draggedX').innerHTML = 'dragged X: ' + dragX;
            document.getElementById('draggedY').innerHTML = 'dragged Y: ' + dragY;
        }

        function onMouseUp() {
            dragging = false;
            document.getElementById('status').innerHTML = 'status: stop dragging';
            startDragX = 0;
            startDragY = 0;
            // do your end of dragging stuff
        }

        // handlers bound to the element only once
        var onMouseDown = addEvent ('.touchsquare', 'mousedown', onMouseDown);
        var onMouseMove = addEvent ('.touchsquare', 'mousemove', onMouseMove);
        var onMouseUp = addEvent ('.touchsquare', 'mouseup'  , onMouseUp);







        // var touchsquare = document.querySelector(".touchsquare");
        // var circle = document.getElementById("circ");
        // console.log(touchsquare);
        // touchsquare.addEventListener ("mousedown", function (eve) {
        //     console.log("fired");
        //     let dim = touchsquare.getBoundingClientRect();
        //     console.log(dim);
        //     let posx = event.clientX - dim.left;
        //     let posy = event.clientY - dim.top;
                    
        //     circle.setAttribute("cx",posx);
        //     circle.setAttribute("cy",posy);
        //     document.querySelector("#source").innerHTML =  posx + " " + posy + "  <br>" +dim.left+ " " + dim.top;
                
        //     eve.preventDefault();
        // });


    </script>
</body>
</html>